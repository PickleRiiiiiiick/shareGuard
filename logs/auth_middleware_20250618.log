2025-06-18 11:52:25,488 - auth_middleware - DEBUG - [auth.py:170] - Processing request to: /api/v1/auth/verify
2025-06-18 11:52:25,490 - auth_middleware - DEBUG - [auth.py:178] - Auth header: Bearer eyJhbGciOiJIU
2025-06-18 11:52:25,492 - auth_middleware - DEBUG - [auth.py:21] - Validating token: eyJhbGciOiJIUzI1NiIs...
2025-06-18 11:52:25,493 - auth_middleware - DEBUG - [auth.py:26] - Checking for active session...
2025-06-18 11:52:25,543 - auth_middleware - DEBUG - [auth.py:36] - Found active session: 1007
2025-06-18 11:52:25,544 - auth_middleware - DEBUG - [auth.py:37] - Session expires at: 2025-06-18 13:04:32.937000
2025-06-18 11:52:25,544 - auth_middleware - WARNING - [auth.py:41] - Session has expired
2025-06-18 11:52:25,548 - auth_middleware - ERROR - [auth.py:202] - HTTP error in middleware: 401 - Token expired
2025-06-18 11:52:25,561 - auth_middleware - DEBUG - [auth.py:170] - Processing request to: /api/v1/auth/verify
2025-06-18 11:52:25,561 - auth_middleware - DEBUG - [auth.py:178] - Auth header: Bearer eyJhbGciOiJIU
2025-06-18 11:52:25,561 - auth_middleware - DEBUG - [auth.py:21] - Validating token: eyJhbGciOiJIUzI1NiIs...
2025-06-18 11:52:25,561 - auth_middleware - DEBUG - [auth.py:26] - Checking for active session...
2025-06-18 11:52:25,563 - auth_middleware - WARNING - [auth.py:33] - No active session found
2025-06-18 11:52:25,563 - auth_middleware - ERROR - [auth.py:202] - HTTP error in middleware: 401 - Invalid token
2025-06-18 11:52:27,659 - auth_middleware - DEBUG - [auth.py:170] - Processing request to: /api/v1/auth/login
2025-06-18 11:52:27,659 - auth_middleware - DEBUG - [auth.py:174] - Allowing access to public route: /api/v1/auth/login
2025-06-18 11:52:30,228 - auth_middleware - DEBUG - [auth.py:170] - Processing request to: /api/v1/targets/
2025-06-18 11:52:30,228 - auth_middleware - DEBUG - [auth.py:178] - Auth header: Bearer eyJhbGciOiJIU
2025-06-18 11:52:30,229 - auth_middleware - DEBUG - [auth.py:21] - Validating token: eyJhbGciOiJIUzI1NiIs...
2025-06-18 11:52:30,229 - auth_middleware - DEBUG - [auth.py:26] - Checking for active session...
2025-06-18 11:52:30,230 - auth_middleware - DEBUG - [auth.py:36] - Found active session: 1008
2025-06-18 11:52:30,230 - auth_middleware - DEBUG - [auth.py:37] - Session expires at: 2025-06-19 18:52:27.690000
2025-06-18 11:52:30,230 - auth_middleware - DEBUG - [auth.py:48] - Attempting JWT validation...
2025-06-18 11:52:30,231 - auth_middleware - DEBUG - [auth.py:54] - JWT validation successful: {'sub': '1', 'name': 'shareguard.com\\ShareGuardService', 'exp': 1750359147, 'iat': 1750272747}
2025-06-18 11:52:30,231 - auth_middleware - DEBUG - [auth.py:64] - Looking up service account: 1
2025-06-18 11:52:30,234 - auth_middleware - DEBUG - [auth.py:71] - Successfully validated token for account: ShareGuardService
2025-06-18 11:52:30,241 - auth_middleware - DEBUG - [auth.py:106] - Auth header: Bearer eyJhbGciOiJIU
2025-06-18 11:52:30,241 - auth_middleware - DEBUG - [auth.py:21] - Validating token: eyJhbGciOiJIUzI1NiIs...
2025-06-18 11:52:30,242 - auth_middleware - DEBUG - [auth.py:26] - Checking for active session...
2025-06-18 11:52:30,243 - auth_middleware - DEBUG - [auth.py:36] - Found active session: 1008
2025-06-18 11:52:30,243 - auth_middleware - DEBUG - [auth.py:37] - Session expires at: 2025-06-19 18:52:27.690000
2025-06-18 11:52:30,243 - auth_middleware - DEBUG - [auth.py:48] - Attempting JWT validation...
2025-06-18 11:52:30,244 - auth_middleware - DEBUG - [auth.py:54] - JWT validation successful: {'sub': '1', 'name': 'shareguard.com\\ShareGuardService', 'exp': 1750359147, 'iat': 1750272747}
2025-06-18 11:52:30,244 - auth_middleware - DEBUG - [auth.py:64] - Looking up service account: 1
2025-06-18 11:52:30,245 - auth_middleware - DEBUG - [auth.py:71] - Successfully validated token for account: ShareGuardService
2025-06-18 11:52:30,246 - auth_middleware - DEBUG - [auth.py:134] - Account permissions: ['targets:read', 'targets:create', 'targets:update', 'targets:delete', 'scan:execute', 'scan:read']
2025-06-18 11:52:30,246 - auth_middleware - DEBUG - [auth.py:135] - Required permissions: ['targets:read']
2025-06-18 11:52:30,282 - auth_middleware - DEBUG - [auth.py:170] - Processing request to: /api/v1/targets/1004/stats
2025-06-18 11:52:30,282 - auth_middleware - DEBUG - [auth.py:178] - Auth header: Bearer eyJhbGciOiJIU
2025-06-18 11:52:30,282 - auth_middleware - DEBUG - [auth.py:21] - Validating token: eyJhbGciOiJIUzI1NiIs...
2025-06-18 11:52:30,282 - auth_middleware - DEBUG - [auth.py:26] - Checking for active session...
2025-06-18 11:52:30,284 - auth_middleware - DEBUG - [auth.py:36] - Found active session: 1008
2025-06-18 11:52:30,284 - auth_middleware - DEBUG - [auth.py:37] - Session expires at: 2025-06-19 18:52:27.690000
2025-06-18 11:52:30,284 - auth_middleware - DEBUG - [auth.py:48] - Attempting JWT validation...
2025-06-18 11:52:30,284 - auth_middleware - DEBUG - [auth.py:54] - JWT validation successful: {'sub': '1', 'name': 'shareguard.com\\ShareGuardService', 'exp': 1750359147, 'iat': 1750272747}
2025-06-18 11:52:30,285 - auth_middleware - DEBUG - [auth.py:64] - Looking up service account: 1
2025-06-18 11:52:30,286 - auth_middleware - DEBUG - [auth.py:71] - Successfully validated token for account: ShareGuardService
2025-06-18 11:52:30,287 - auth_middleware - DEBUG - [auth.py:170] - Processing request to: /api/v1/targets/2/stats
2025-06-18 11:52:30,287 - auth_middleware - DEBUG - [auth.py:178] - Auth header: Bearer eyJhbGciOiJIU
2025-06-18 11:52:30,288 - auth_middleware - DEBUG - [auth.py:21] - Validating token: eyJhbGciOiJIUzI1NiIs...
2025-06-18 11:52:30,288 - auth_middleware - DEBUG - [auth.py:26] - Checking for active session...
2025-06-18 11:52:30,289 - auth_middleware - DEBUG - [auth.py:36] - Found active session: 1008
2025-06-18 11:52:30,289 - auth_middleware - DEBUG - [auth.py:37] - Session expires at: 2025-06-19 18:52:27.690000
2025-06-18 11:52:30,289 - auth_middleware - DEBUG - [auth.py:48] - Attempting JWT validation...
2025-06-18 11:52:30,290 - auth_middleware - DEBUG - [auth.py:54] - JWT validation successful: {'sub': '1', 'name': 'shareguard.com\\ShareGuardService', 'exp': 1750359147, 'iat': 1750272747}
2025-06-18 11:52:30,290 - auth_middleware - DEBUG - [auth.py:64] - Looking up service account: 1
2025-06-18 11:52:30,291 - auth_middleware - DEBUG - [auth.py:71] - Successfully validated token for account: ShareGuardService
2025-06-18 11:52:30,293 - auth_middleware - DEBUG - [auth.py:170] - Processing request to: /api/v1/targets/1/stats
2025-06-18 11:52:30,294 - auth_middleware - DEBUG - [auth.py:178] - Auth header: Bearer eyJhbGciOiJIU
2025-06-18 11:52:30,294 - auth_middleware - DEBUG - [auth.py:21] - Validating token: eyJhbGciOiJIUzI1NiIs...
2025-06-18 11:52:30,294 - auth_middleware - DEBUG - [auth.py:26] - Checking for active session...
2025-06-18 11:52:30,295 - auth_middleware - DEBUG - [auth.py:36] - Found active session: 1008
2025-06-18 11:52:30,295 - auth_middleware - DEBUG - [auth.py:37] - Session expires at: 2025-06-19 18:52:27.690000
2025-06-18 11:52:30,296 - auth_middleware - DEBUG - [auth.py:48] - Attempting JWT validation...
2025-06-18 11:52:30,296 - auth_middleware - DEBUG - [auth.py:54] - JWT validation successful: {'sub': '1', 'name': 'shareguard.com\\ShareGuardService', 'exp': 1750359147, 'iat': 1750272747}
2025-06-18 11:52:30,296 - auth_middleware - DEBUG - [auth.py:64] - Looking up service account: 1
2025-06-18 11:52:30,297 - auth_middleware - DEBUG - [auth.py:71] - Successfully validated token for account: ShareGuardService
2025-06-18 11:52:30,300 - auth_middleware - DEBUG - [auth.py:106] - Auth header: Bearer eyJhbGciOiJIU
2025-06-18 11:52:30,300 - auth_middleware - DEBUG - [auth.py:21] - Validating token: eyJhbGciOiJIUzI1NiIs...
2025-06-18 11:52:30,301 - auth_middleware - DEBUG - [auth.py:26] - Checking for active session...
2025-06-18 11:52:30,302 - auth_middleware - DEBUG - [auth.py:36] - Found active session: 1008
2025-06-18 11:52:30,302 - auth_middleware - DEBUG - [auth.py:37] - Session expires at: 2025-06-19 18:52:27.690000
2025-06-18 11:52:30,302 - auth_middleware - DEBUG - [auth.py:48] - Attempting JWT validation...
2025-06-18 11:52:30,302 - auth_middleware - DEBUG - [auth.py:54] - JWT validation successful: {'sub': '1', 'name': 'shareguard.com\\ShareGuardService', 'exp': 1750359147, 'iat': 1750272747}
2025-06-18 11:52:30,303 - auth_middleware - DEBUG - [auth.py:64] - Looking up service account: 1
2025-06-18 11:52:30,304 - auth_middleware - DEBUG - [auth.py:71] - Successfully validated token for account: ShareGuardService
2025-06-18 11:52:30,304 - auth_middleware - DEBUG - [auth.py:134] - Account permissions: ['targets:read', 'targets:create', 'targets:update', 'targets:delete', 'scan:execute', 'scan:read']
2025-06-18 11:52:30,304 - auth_middleware - DEBUG - [auth.py:135] - Required permissions: ['targets:read']
2025-06-18 11:52:30,314 - auth_middleware - DEBUG - [auth.py:106] - Auth header: Bearer eyJhbGciOiJIU
2025-06-18 11:52:30,314 - auth_middleware - DEBUG - [auth.py:21] - Validating token: eyJhbGciOiJIUzI1NiIs...
2025-06-18 11:52:30,314 - auth_middleware - DEBUG - [auth.py:26] - Checking for active session...
2025-06-18 11:52:30,318 - auth_middleware - DEBUG - [auth.py:36] - Found active session: 1008
2025-06-18 11:52:30,318 - auth_middleware - DEBUG - [auth.py:37] - Session expires at: 2025-06-19 18:52:27.690000
2025-06-18 11:52:30,318 - auth_middleware - DEBUG - [auth.py:48] - Attempting JWT validation...
2025-06-18 11:52:30,319 - auth_middleware - DEBUG - [auth.py:54] - JWT validation successful: {'sub': '1', 'name': 'shareguard.com\\ShareGuardService', 'exp': 1750359147, 'iat': 1750272747}
2025-06-18 11:52:30,319 - auth_middleware - DEBUG - [auth.py:64] - Looking up service account: 1
2025-06-18 11:52:30,320 - auth_middleware - DEBUG - [auth.py:71] - Successfully validated token for account: ShareGuardService
2025-06-18 11:52:30,321 - auth_middleware - DEBUG - [auth.py:134] - Account permissions: ['targets:read', 'targets:create', 'targets:update', 'targets:delete', 'scan:execute', 'scan:read']
2025-06-18 11:52:30,321 - auth_middleware - DEBUG - [auth.py:135] - Required permissions: ['targets:read']
2025-06-18 11:52:30,325 - auth_middleware - DEBUG - [auth.py:106] - Auth header: Bearer eyJhbGciOiJIU
2025-06-18 11:52:30,325 - auth_middleware - DEBUG - [auth.py:21] - Validating token: eyJhbGciOiJIUzI1NiIs...
2025-06-18 11:52:30,325 - auth_middleware - DEBUG - [auth.py:26] - Checking for active session...
2025-06-18 11:52:30,327 - auth_middleware - DEBUG - [auth.py:36] - Found active session: 1008
2025-06-18 11:52:30,327 - auth_middleware - DEBUG - [auth.py:37] - Session expires at: 2025-06-19 18:52:27.690000
2025-06-18 11:52:30,328 - auth_middleware - DEBUG - [auth.py:48] - Attempting JWT validation...
2025-06-18 11:52:30,328 - auth_middleware - DEBUG - [auth.py:54] - JWT validation successful: {'sub': '1', 'name': 'shareguard.com\\ShareGuardService', 'exp': 1750359147, 'iat': 1750272747}
2025-06-18 11:52:30,329 - auth_middleware - DEBUG - [auth.py:64] - Looking up service account: 1
2025-06-18 11:52:30,330 - auth_middleware - DEBUG - [auth.py:71] - Successfully validated token for account: ShareGuardService
2025-06-18 11:52:30,330 - auth_middleware - DEBUG - [auth.py:134] - Account permissions: ['targets:read', 'targets:create', 'targets:update', 'targets:delete', 'scan:execute', 'scan:read']
2025-06-18 11:52:30,330 - auth_middleware - DEBUG - [auth.py:135] - Required permissions: ['targets:read']
2025-06-18 11:52:31,598 - auth_middleware - DEBUG - [auth.py:170] - Processing request to: /api/v1/scan/results/1004
2025-06-18 11:52:31,599 - auth_middleware - DEBUG - [auth.py:178] - Auth header: Bearer eyJhbGciOiJIU
2025-06-18 11:52:31,599 - auth_middleware - DEBUG - [auth.py:21] - Validating token: eyJhbGciOiJIUzI1NiIs...
2025-06-18 11:52:31,599 - auth_middleware - DEBUG - [auth.py:26] - Checking for active session...
2025-06-18 11:52:31,601 - auth_middleware - DEBUG - [auth.py:36] - Found active session: 1008
2025-06-18 11:52:31,601 - auth_middleware - DEBUG - [auth.py:37] - Session expires at: 2025-06-19 18:52:27.690000
2025-06-18 11:52:31,602 - auth_middleware - DEBUG - [auth.py:48] - Attempting JWT validation...
2025-06-18 11:52:31,602 - auth_middleware - DEBUG - [auth.py:54] - JWT validation successful: {'sub': '1', 'name': 'shareguard.com\\ShareGuardService', 'exp': 1750359147, 'iat': 1750272747}
2025-06-18 11:52:31,602 - auth_middleware - DEBUG - [auth.py:64] - Looking up service account: 1
2025-06-18 11:52:31,603 - auth_middleware - DEBUG - [auth.py:71] - Successfully validated token for account: ShareGuardService
2025-06-18 11:52:32,615 - auth_middleware - DEBUG - [auth.py:170] - Processing request to: /api/v1/scan/results/1004
2025-06-18 11:52:32,615 - auth_middleware - DEBUG - [auth.py:178] - Auth header: Bearer eyJhbGciOiJIU
2025-06-18 11:52:32,616 - auth_middleware - DEBUG - [auth.py:21] - Validating token: eyJhbGciOiJIUzI1NiIs...
2025-06-18 11:52:32,616 - auth_middleware - DEBUG - [auth.py:26] - Checking for active session...
2025-06-18 11:52:32,617 - auth_middleware - DEBUG - [auth.py:36] - Found active session: 1008
2025-06-18 11:52:32,617 - auth_middleware - DEBUG - [auth.py:37] - Session expires at: 2025-06-19 18:52:27.690000
2025-06-18 11:52:32,617 - auth_middleware - DEBUG - [auth.py:48] - Attempting JWT validation...
2025-06-18 11:52:32,618 - auth_middleware - DEBUG - [auth.py:54] - JWT validation successful: {'sub': '1', 'name': 'shareguard.com\\ShareGuardService', 'exp': 1750359147, 'iat': 1750272747}
2025-06-18 11:52:32,618 - auth_middleware - DEBUG - [auth.py:64] - Looking up service account: 1
2025-06-18 11:52:32,619 - auth_middleware - DEBUG - [auth.py:71] - Successfully validated token for account: ShareGuardService
2025-06-18 11:52:34,629 - auth_middleware - DEBUG - [auth.py:170] - Processing request to: /api/v1/scan/results/1004
2025-06-18 11:52:34,630 - auth_middleware - DEBUG - [auth.py:178] - Auth header: Bearer eyJhbGciOiJIU
2025-06-18 11:52:34,630 - auth_middleware - DEBUG - [auth.py:21] - Validating token: eyJhbGciOiJIUzI1NiIs...
2025-06-18 11:52:34,630 - auth_middleware - DEBUG - [auth.py:26] - Checking for active session...
2025-06-18 11:52:34,631 - auth_middleware - DEBUG - [auth.py:36] - Found active session: 1008
2025-06-18 11:52:34,632 - auth_middleware - DEBUG - [auth.py:37] - Session expires at: 2025-06-19 18:52:27.690000
2025-06-18 11:52:34,632 - auth_middleware - DEBUG - [auth.py:48] - Attempting JWT validation...
2025-06-18 11:52:34,632 - auth_middleware - DEBUG - [auth.py:54] - JWT validation successful: {'sub': '1', 'name': 'shareguard.com\\ShareGuardService', 'exp': 1750359147, 'iat': 1750272747}
2025-06-18 11:52:34,632 - auth_middleware - DEBUG - [auth.py:64] - Looking up service account: 1
2025-06-18 11:52:34,633 - auth_middleware - DEBUG - [auth.py:71] - Successfully validated token for account: ShareGuardService
2025-06-18 11:52:38,652 - auth_middleware - DEBUG - [auth.py:170] - Processing request to: /api/v1/scan/results/1004
2025-06-18 11:52:38,652 - auth_middleware - DEBUG - [auth.py:178] - Auth header: Bearer eyJhbGciOiJIU
2025-06-18 11:52:38,653 - auth_middleware - DEBUG - [auth.py:21] - Validating token: eyJhbGciOiJIUzI1NiIs...
2025-06-18 11:52:38,653 - auth_middleware - DEBUG - [auth.py:26] - Checking for active session...
2025-06-18 11:52:38,654 - auth_middleware - DEBUG - [auth.py:36] - Found active session: 1008
2025-06-18 11:52:38,654 - auth_middleware - DEBUG - [auth.py:37] - Session expires at: 2025-06-19 18:52:27.690000
2025-06-18 11:52:38,655 - auth_middleware - DEBUG - [auth.py:48] - Attempting JWT validation...
2025-06-18 11:52:38,655 - auth_middleware - DEBUG - [auth.py:54] - JWT validation successful: {'sub': '1', 'name': 'shareguard.com\\ShareGuardService', 'exp': 1750359147, 'iat': 1750272747}
2025-06-18 11:52:38,655 - auth_middleware - DEBUG - [auth.py:64] - Looking up service account: 1
2025-06-18 11:52:38,656 - auth_middleware - DEBUG - [auth.py:71] - Successfully validated token for account: ShareGuardService
